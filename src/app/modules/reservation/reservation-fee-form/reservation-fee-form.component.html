<div class="payment-dialog">
  <h2 mat-dialog-title class="text-2xl font-bold text-gray-800 pb-2 border-b border-gray-200">
    Reservation Fee - {{ data.fullName }}
  </h2>

  <mat-dialog-content class="min-w-[500px]">
    <form [formGroup]="formGroup" class="flex flex-col gap-6 py-4">
      <!-- Reservation Details -->
      <div class="bg-gradient-to-r from-gray-50 to-slate-50 p-5 rounded-lg border-2 border-gray-200 shadow-sm">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Reservation Details</h3>
        <div class="flex flex-col gap-3">
          <!-- Food Package -->
          @if(foodPackages.length > 0) {
            <div class="flex flex-col gap-2">
              <span class="font-semibold text-gray-700">{{ labels.headers.reservationPackage }}:</span>
              @for(pkg of foodPackages; track $index) {
                <div class="flex justify-between items-center pl-4">
                  <span class="text-gray-600">{{ pkg.name }}</span>
                  <span class="font-medium text-gray-800">₱{{ pkg.price | number:'1.2-2' }}</span>
                </div>
              }
            </div>
          }

          <!-- Service -->
          @if(servicePackages.length > 0) {
            <div class="flex flex-col gap-2 pt-2 border-t border-gray-200">
              <span class="font-semibold text-gray-700">{{ labels.headers.service }}:</span>
              @for(service of servicePackages; track $index) {
                <div class="flex justify-between items-center pl-4">
                  <span class="text-gray-600">
                    {{ service.name }}
                    @if(service.quantity > 1) {
                      <span class="text-sm text-gray-500">(x{{ service.quantity }})</span>
                    }
                  </span>
                  <span class="font-medium text-gray-800">
                    ₱{{ (service.price * service.quantity) | number:'1.2-2' }}
                  </span>
                </div>
              }
            </div>
          }

          <!-- Venue -->
          @if(venueName) {
            <div class="flex flex-col gap-2 pt-2 border-t border-gray-200">
              <span class="font-semibold text-gray-700">{{ labels.headers.venue }}:</span>
              <div class="flex justify-between items-center pl-4">
                <span class="text-gray-600">{{ venueName }}</span>
                <span class="font-medium text-gray-800">₱{{ venuePrice | number:'1.2-2' }}</span>
              </div>
            </div>
          }

          <!-- Discount -->
          @if(data?.isDiscount || data?.discount) {
            <div class="flex flex-col gap-2 pt-2 border-t border-gray-200">
              <span class="font-semibold text-gray-700">Discount:</span>
              <div class="flex justify-between items-center pl-4">
                <span class="text-gray-600">
                  @if(data.isDiscount && data.discount) {
                    {{ data.discount }}{{ data.discount.toString().includes('%') ? '' : '%' }}
                  } @else {
                    {{ data.discount || 'N/A' }}
                  }
                </span>
                @if(data.discountAmount) {
                  <span class="font-medium text-red-600">-₱{{ data.discountAmount | number:'1.2-2' }}</span>
                } @else {
                  <span class="font-medium text-gray-800">-</span>
                }
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Payment Information Summary -->
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-5 rounded-lg border-2 border-blue-200 shadow-sm">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Payment Summary</h3>
        <div class="flex flex-col gap-3">
          <div class="flex justify-between items-center">
            <span class="font-semibold text-gray-700">Total Price:</span>
            <span class="font-bold text-lg text-gray-900">₱{{ data?.totalPrice | number:'1.2-2' }}</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="font-semibold text-gray-700">Reservation Fee (10%):</span>
            <span class="font-bold text-lg text-blue-600">₱{{ reservationFee | number:'1.2-2' }}</span>
          </div>
        </div>
      </div>

      <!-- Payment Method -->
      <div class="flex flex-col gap-3">
        <h3 class="text-lg font-semibold text-gray-800">Payment Method</h3>
        <mat-radio-group 
          formControlName="paymentMethod" 
          aria-label="Select payment method"
          class="flex flex-col gap-3">
          <mat-radio-button 
            *ngFor="let option of paymentMethod" 
            [value]="option"
            class="py-2 px-3 rounded-lg hover:bg-gray-50 transition-colors">
            {{ option }}
          </mat-radio-button>
        </mat-radio-group>
      </div>

      <!-- Reference Number (conditional) -->
      <div *ngIf="PaymentMethod !== 'Cash'" class="flex flex-col gap-2">
        <label class="text-sm font-medium text-gray-700">{{ labels.headers.refNo }}</label>
        <mat-form-field class="w-full" appearance="outline">
          <input
            matInput
            formControlName="refNo"
            [placeholder]="labels.headers.refNo"
          />
          @if(hasError('refNo')){
            <mat-error>Reference number is required.</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Amount -->
      <div class="flex flex-col gap-2">
        <label class="text-sm font-medium text-gray-700">{{ labels.headers.amount }}</label>
        <mat-form-field class="w-full" appearance="outline">
          <input
            matInput
            type="text"
            (keypress)="onlyAllowDecimal($event)"
            (paste)="onPasteDecimal($event)"
            formControlName="amount"
            [readonly]="true"
            [placeholder]="labels.headers.amount"
          />
          @if(hasError('amount')){
            <mat-error>Amount is required.</mat-error>
          }
          @if(minValueError('amount')){
            <mat-error>Amount must be greater than 0.</mat-error>
          }
        </mat-form-field>
      </div>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="px-6 pb-4 pt-4 border-t border-gray-200 bg-gray-50">
    <button mat-button (click)="close()" class="px-4">Cancel</button>
    <button mat-raised-button color="primary" (click)="submit()" class="px-6">
      <mat-icon class="mr-2">payment</mat-icon>
      Submit Payment
    </button>
  </mat-dialog-actions>
</div>

