<!-- Venue List -->
@if (venueList$ | async; as venueList) {
<form [formGroup]="venueFormGroup">
  <div
    attr.data-cy="{{ labels.title }}-list-page-container"
    class="table-wrapper"
  >
    <div
      style="display: flex; justify-content: flex-end"
      class="absolute top-12 right-2 gap-2"
    >
      <a
        mat-flat-button
        class="flex items-center gap-2 pl-4 pr-5 bg-rose-300"
        [routerLink]="['new']"
      >
        <mat-icon class="icon-size-5">add</mat-icon>
        <span class="hidden sm:block">{{ labels.new }}</span>
      </a>

      <a
        mat-flat-button
        class="flex items-center gap-2 pl-4 pr-5 bg-rose-300"
        (click)="generate()"
      >
        <span class="hidden sm:block">{{ labels.generate }}</span>
      </a>
    </div>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>filter_alt</mat-icon>
          <mat-icon>sort</mat-icon>
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div class="grid gap-2 venue-list-grid">
        <div
          attr.data-cy="{{ labels.title }}-list-table-header-{{
            labels.headers.search
          }}"
          class="table-header-item"
        >
          <mat-form-field class="flex flex-row w-full" appearance="outline">
            <mat-icon matPrefix>search</mat-icon>
            <input
              class="ms-2"
              matInput
              [placeholder]="labels.placeholder.search"
              formControlName="searchValue"
            />
          </mat-form-field>
        </div>
        <div class="flex flex-row gap-3">
          <button
            mat-raised-button
            class="flex items-center justify-center gap-2 bg-rose-300"
            (click)="searchFilter(venueFormGroup)"
          >
            <mat-icon class="icon-size-5">search</mat-icon>
            <span class="hidden sm:block">{{ labels.placeholder.search }}</span>
          </button>
          <button
            mat-raised-button
            class="flex items-center justify-center gap-2 bg-rose-300"
            (click)="resetFilter()"
          >
            <mat-icon class="icon-size-5">rotate_left</mat-icon>
            <span class="hidden sm:block">{{ labels.placeholder.reset }}</span>
          </button>
        </div>
      </div>
    </mat-expansion-panel>
    <!-- Header -->
    <div
      attr.data-cy="{{ labels.title }}-list-header"
      class="venue-list-grid table-header"
    >
      <div
        attr.data-cy="{{ labels.title }}-list-table-header-{{
          labels.headers.name
        }}"
        class="table-header-item"
      >
        {{ labels.headers.name | titlecase }}
      </div>

      <div
        attr.data-cy="{{ labels.title }}-list-table-header-{{
          labels.headers.createdAt
        }}"
        class="table-header-item"
      >
        {{ labels.headers.createdAt | titlecase }}
      </div>

      <div
        attr.data-cy="{{ labels.title }}-list-table-header-{{
          labels.headers.updatedAt
        }}"
        class="table-header-item"
      >
        {{ labels.headers.updatedAt | titlecase }}
      </div>

      <div
        attr.data-cy="{{ labels.title }}-list-table-header-{{
          labels.headers.action
        }}"
        class="table-header-item"
      >
        <div class="min-w-32">{{ labels.headers.action }}</div>
      </div>
      <!-- Rows -->
      @if (venueList.data.length > 0) { @for (row of venueList.data; track $index)
      {
      <!-- Name -->
      <div
        attr.data-cy="{{ labels.title }}-list-table-row-{{ $index }}-{{
          labels.headers.name
        }}"
        class="text-start table-row-item"
      >
        {{ row?.name ?? labels.notApplicable }}
      </div>

      <!-- Created At -->
      <div
        attr.data-cy="{{ labels.title }}-list-table-row-{{ $index }}-{{
          labels.headers.createdAt
        }}"
        class="text-start table-row-item"
      >
        {{
          (row?.createdAt | date : dateFormat.dateOnly) ?? labels.notApplicable
        }}
      </div>

      <!-- Updated At -->
      <div
        attr.data-cy="{{ labels.title }}-list-table-row-{{ $index }}-{{
          labels.headers.updatedAt
        }}"
        class="text-start table-row-item"
      >
        {{
          (row?.updatedAt | date : dateFormat.dateOnly) ?? labels.notApplicable
        }}
      </div>

      <!-- Actions -->
      <div
        attr.data-cy="{{ labels.title }}-list-table-row-{{ $index }}-{{
          labels.headers.action
        }}"
      >
        <div class="flex gap-2 my-3 ms-5">
          <a
            [matTooltip]="labels.actions.edit"
            matTooltipPosition="above"
            [routerLink]="[row.venueId, 'edit']"
          >
            <mat-icon class="text-black hover:text-green-300">edit</mat-icon>
          </a>
          <button
          *ngIf="hasPermission()"
            [matTooltip]="labels.actions.delete"
            matTooltipPosition="above"
          >
            <mat-icon
              class="text-black hover:text-red-500"
              (click)="openDeleteConfirmation({ venueId: row?.venueId }, module.venue, getDataName(row))"
              >delete</mat-icon
            >
          </button>
        </div>
      </div>
      } } @else {
      <!-- Template when list is null -->
      <cps-no-data
        moduleName="Supplier List"
        class="row-span-3 col-span-full"
      ></cps-no-data>
      }
    </div>
    <app-paginator
      aria-label="Amla Code List paginator"
      class="paginator"
      [records]="paginate.totalRecords"
      [entries]="paginate.totalEntries"
      [pageIndex]="paginate.pageIndex"
      [pageSize]="paginate.pageSize"
      (page)="handlePageEvent($event)"
    >
    </app-paginator>
  </div>
</form>
}
